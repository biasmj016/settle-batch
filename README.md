# 정산 배치 시스템

이 프로젝트는 정산 배치 처리를 수행하는 예제입니다.       
파트너사와 계약을 맺고 서비스를 제공하는 경우, 파트너사의 거래 내역과 내부 시스템의 거래 내역을 비교하여 정산을 진행합니다.      
고객이 내부 시스템을 통해 거래를 진행하면 고객 수수료 1,000원이 부과되며, 거래 처리 과정에서 파트너사의 API를 사용한 비용으로 500원이 부과된다고 가정합니다.      
정산 결과는 다음과 같이 분류됩니다.

## 정산 기준
- **정상거래건 (Matched Transaction):**
    - 내부 시스템과 파트너사의 거래 내역이 모두 존재하는 경우
    - 고객 수수료 1,000원에서 파트너 수수료 500원을 차감하여 순이익 500원, 총 수익 1,000원을 산출
- **취소건 (Cancellation Transaction):**
    - 내부 시스템에는 거래 내역이 존재하지만, 파트너사의 거래 내역이 없는 경우
    - 고객 환불로 인해 1,000원 손실 처리
- **이상거래건 (Suspicious Transaction):**
    - 내부 시스템에는 거래 내역이 없지만, 파트너사의 거래 내역이 존재하는 경우
    - 확인이 필요한 이상 거래로 간주하며 임시 손실 1,000원 처리

또한, 정산 배치가 완료되면 오늘자의 정산 통계(건수, 이익/손실)를 산출하여 Kafka를 통해 알림 메시지를 전송합니다.

## 주요 기술 스택

- **Spring Boot & Spring Batch:**  배치 작업 구성 및 실행 (청크 기반, Tasklet 사용)
- **Kotlin**
- **Quartz:**  배치 작업의 스케줄링
- **Kafka:** 정산 통계 알림 메시지 전송
- **PostgreSQL:**  정산 관련 데이터 저장
- **Redis:**  파트너 거래내역 캐싱
- **병렬 처리:**  멀티스레드 TaskExecutor 및 청크 기반 배치 처리